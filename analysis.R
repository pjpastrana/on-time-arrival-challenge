library("stringr")

DATA_PATH <- "~/data/startupml/ontime_arrival_challenge"

JAN2014 <- read.csv(str_c(DATA_PATH, "/JAN2014/108043198_T_ONTIME.csv"))
# FEB2014 <- read.csv(str_c(DATA_PATH, "/FEB2014/108043198_T_ONTIME.csv"))
# MAR2014 <- read.csv(str_c(DATA_PATH, "/MAR2014/108043198_T_ONTIME.csv"))
# APR2014 <- read.csv(str_c(DATA_PATH, "/APR2014/108043198_T_ONTIME.csv"))
# MAY2014 <- read.csv(str_c(DATA_PATH, "/MAY2014/108043198_T_ONTIME.csv"))
# JUN2014 <- read.csv(str_c(DATA_PATH, "/JUN2014/108043198_T_ONTIME.csv"))
# JUL2014 <- read.csv(str_c(DATA_PATH, "/JUL2014/108043198_T_ONTIME.csv"))
# AUG2014 <- read.csv(str_c(DATA_PATH, "/AUG2014/108043198_T_ONTIME.csv"))
# SEP2014 <- read.csv(str_c(DATA_PATH, "/SEP2014/108043198_T_ONTIME.csv"))
# OCT2014 <- read.csv(str_c(DATA_PATH, "/OCT2014/108043198_T_ONTIME.csv"))
# NOV2014 <- read.csv(str_c(DATA_PATH, "/NOV2014/108043198_T_ONTIME.csv"))
# DEC2014 <- read.csv(str_c(DATA_PATH, "/DEC2014/108043198_T_ONTIME.csv"))


JAN2015 <- read.csv(str_c(DATA_PATH, "/JAN2015/108043198_T_ONTIME.csv"))
# FEB2015 <- read.csv(str_c(DATA_PATH, "/FEB2015/108043198_T_ONTIME.csv"))
# MAR2015 <- read.csv(str_c(DATA_PATH, "/MAR2015/108043198_T_ONTIME.csv"))
# APR2015 <- read.csv(str_c(DATA_PATH, "/APR2015/108043198_T_ONTIME.csv"))
# MAY2015 <- read.csv(str_c(DATA_PATH, "/MAY2015/108043198_T_ONTIME.csv"))
# JUN2015 <- read.csv(str_c(DATA_PATH, "/JUN2015/108043198_T_ONTIME.csv"))
# JUL2015 <- read.csv(str_c(DATA_PATH, "/JUL2015/108043198_T_ONTIME.csv"))
# AUG2015 <- read.csv(str_c(DATA_PATH, "/AUG2015/108043198_T_ONTIME.csv"))
# SEP2015 <- read.csv(str_c(DATA_PATH, "/SEP2015/108043198_T_ONTIME.csv"))
# OCT2015 <- read.csv(str_c(DATA_PATH, "/OCT2015/108043198_T_ONTIME.csv"))
# NOV2015 <- read.csv(str_c(DATA_PATH, "/NOV2015/108043198_T_ONTIME.csv"))
# DEC2015 <- read.csv(str_c(DATA_PATH, "/DEC2015/108043198_T_ONTIME.csv"))
# 
# 
# JAN2016 <- read.csv(str_c(DATA_PATH, "/JAN2016/107904530_T_ONTIME.csv"))
# FEB2016 <- read.csv(str_c(DATA_PATH, "/FEB2016/107904530_T_ONTIME.csv"))
# MAR2016 <- read.csv(str_c(DATA_PATH, "/MAR2016/107904530_T_ONTIME.csv"))
# APR2016 <- read.csv(str_c(DATA_PATH, "/APR2016/107904530_T_ONTIME.csv"))
# MAY2016 <- read.csv(str_c(DATA_PATH, "/MAY2016/107904530_T_ONTIME.csv"))
# JUN2016 <- read.csv(str_c(DATA_PATH, "/JUN2016/107904530_T_ONTIME.csv"))
# JUL2016 <- read.csv(str_c(DATA_PATH, "/JUL2016/107904530_T_ONTIME.csv"))
# AUG2016 <- read.csv(str_c(DATA_PATH, "/AUG2016/107904530_T_ONTIME.csv"))
# SEP2016 <- read.csv(str_c(DATA_PATH, "/SEP2016/107904530_T_ONTIME.csv"))
# OCT2016 <- read.csv(str_c(DATA_PATH, "/OCT2016/107904530_T_ONTIME.csv"))
# NOV2016 <- read.csv(str_c(DATA_PATH, "/NOV2016/107904530_T_ONTIME.csv"))


# TRAINING_DATA <- rbind(
#   JAN2014,
#   FEB2014,
#   MAR2014,
#   APR2014,
#   MAY2014,
#   JUN2014,
#   JUL2014,
#   AUG2014,
#   SEP2014,
#   OCT2014,
#   NOV2014,
#   DEC2014
# )
TRAINING_DATA <- rbind(
  JAN2014)

rm(
  JAN2014)

cols_of_interest <- c("QUARTER","MONTH","AIRLINE_ID","FL_NUM","ORIGIN_AIRPORT_ID","ORIGIN_CITY_MARKET_ID","ORIGIN_STATE_FIPS","ORIGIN_WAC","DEST_AIRPORT_ID","DEST_CITY_MARKET_ID","DEST_STATE_FIPS","DEST_WAC","CRS_DEP_TIME","DEP_TIME","TAXI_OUT","WHEELS_OFF","WHEELS_ON","TAXI_IN","CRS_ARR_TIME","ARR_TIME", "ARR_DELAY_NEW")
cols_of_interest_x <- c("QUARTER","MONTH","AIRLINE_ID","FL_NUM","ORIGIN_AIRPORT_ID","ORIGIN_CITY_MARKET_ID","ORIGIN_STATE_FIPS","ORIGIN_WAC","DEST_AIRPORT_ID","DEST_CITY_MARKET_ID","DEST_STATE_FIPS","DEST_WAC","CRS_DEP_TIME","DEP_TIME","TAXI_OUT","WHEELS_OFF","WHEELS_ON","TAXI_IN","CRS_ARR_TIME","ARR_TIME")
cols_of_interest_y <- c("ARR_DELAY_NEW")
TRAINING_DATA <- TRAINING_DATA[, cols_of_interest]

TESTING_DATA <- rbind(
  JAN2015
)

rm(
  JAN2015)

TESTING_DATA <- TESTING_DATA[, cols_of_interest]

# +WHEELS_ON+TAXI_IN+
model <- lm(ARR_DELAY_NEW ~ QUARTER+MONTH+AIRLINE_ID+FL_NUM+ORIGIN_AIRPORT_ID+ORIGIN_CITY_MARKET_ID+ORIGIN_STATE_FIPS+ORIGIN_WAC+DEST_AIRPORT_ID+DEST_CITY_MARKET_ID+DEST_STATE_FIPS+DEST_WAC+CRS_DEP_TIME+DEP_TIME+TAXI_OUT+WHEELS_OFF+CRS_ARR_TIME+ARR_TIME, data = TRAINING_DATA)
summary(model)
predict(model, TESTING_DATA)

# plot(TRAINING_DATA[, cols_of_interest_x], TRAINING_DATA[, cols_of_interest_y])
